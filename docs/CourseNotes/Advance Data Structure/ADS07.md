## 最近点对问题

在平面上给定 \( n \) 个点，希望找出其中距离最近的两个点。  
输入：平面上 \( n \) 个点 \( P = \{p_1, p_2, \dots, p_n\} \)，每个点 \( p_i = (x_i, y_i) \)。
输出：一对点 \( (p_i, p_j) \)（\( i \ne j \)），使得它们之间的欧几里得距离最小。

分治法步骤：

1. 将点集分别按 x 坐标和 y 坐标排序，得到数组 \( P_x \) 和 \( P_y \)。
2. 用一条垂直线将点集分为左右两半，每边约 \( n/2 \) 个点，递归求解左半的最近距离 \( d_L \)，右半的最近距离 \( d_R \)。令 \( d = \min(d_L, d_R) \)。
3. 合并时要考虑跨越分割线的点对，只需取半宽为 $d$ 的带状区域（strip）即可。对 strip 中的点按 y 坐标排序，检查邻近的点，计算这些候选点对的距离，更新最小距离。

理解：将 strip 划分为边长的 $d/2$ 的方格。希望距离小于 $d$，故一个方格以外的点不用考虑；而因为两边的最小距离都小于 $d$，一个方格内最多只有一个点。所以对于 strip 中的点，只需要检查相邻的 7 个方格，最多有 7 个邻居点，为常数时间。  
实际操作中，因为提前将点集按 y 坐标排序，只需比较后面至多 7 个点。

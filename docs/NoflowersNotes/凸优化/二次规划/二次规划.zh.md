## 二次规划问题的类型（Types of QP problems）

### Quadratic Program (QP) 与 Quadratically Constrained Quadratic Program (QCQP)

**QP：二次规划**

$$
\begin{aligned}
    \min_x\  &\frac{1}{2}\boldsymbol{x}^T\boldsymbol{Q}\boldsymbol{x} + \boldsymbol{c}^T\boldsymbol{x} \\
    \text{s.t.}\ &\boldsymbol{Bx}\leq \boldsymbol{d} \\
    \ &\boldsymbol{Ax} = \boldsymbol{b}
\end{aligned}
$$

当 $\boldsymbol{Q} \succeq \boldsymbol{O}$（半正定）时，该 QP 为凸优化问题；当 $\boldsymbol{Q} = \boldsymbol{O}$ 时就退化成线性规划（LP）。

**QCQP：二次约束的二次规划**

$$
\begin{aligned}
    \min_x\  &\frac{1}{2}\boldsymbol{x}^T\boldsymbol{Q}\boldsymbol{x} + \boldsymbol{c}^T\boldsymbol{x} \\
    \text{s.t.}\ &\frac{1}{2}\boldsymbol{x}^T\boldsymbol{Q}_i\boldsymbol{x} + \boldsymbol{c}_i^T\boldsymbol{x}\leq \boldsymbol{d} + \boldsymbol{d}_i \leq 0, & i = 1, 2, \ldots, m \\
    \ &\boldsymbol{Ax} = \boldsymbol{b}
\end{aligned}
$$

当 $\boldsymbol{Q} \succeq \boldsymbol{O}$ 且对所有 $i$ 有 $\boldsymbol{Q}_i \succeq \boldsymbol{O}$ 时，QCQP 是凸的；若每个 $\boldsymbol{Q}_i = \boldsymbol{O}$，则约束变成线性的，退化为 QP。

!!! examples "线性最小二乘回归（Linear least squares regression）"

    已知 $\boldsymbol{y} \in \mathbb{R}^n, \boldsymbol{X} \in \mathbb{R}^{n \times p}$，求参数 $\boldsymbol{w}\in \mathbb{R}^p$ 使

    $$
    \min_{\boldsymbol{w}}\Vert \boldsymbol{y} - \boldsymbol{Xw} \Vert_2^2
    $$

    从几何上看，就是把 $\boldsymbol{y}$ 正交投影到 $\boldsymbol{X}$ 的列空间 $\operatorname{Range}(\boldsymbol{X})$ 上。

    记
    
    $$
    f(\boldsymbol{w}) = \boldsymbol{w}^T\boldsymbol{X}^T\boldsymbol{Xw} - 2\boldsymbol{y}^T\boldsymbol{Xw} + \boldsymbol{y}^T\boldsymbol{y},
    $$
    
    则 $\boldsymbol{w}^*$ 为最优解当且仅当

    $$
    \nabla f(\boldsymbol{w}^*) = \boldsymbol{0} \Leftrightarrow \boldsymbol{X}^T\boldsymbol{Xw} = \boldsymbol{X}^T\boldsymbol{y}.
    $$

    当且仅当 $\boldsymbol{X}^T\boldsymbol{X} \succ \boldsymbol{O}$（即 $\boldsymbol{X}$ 满列秩）时，$\boldsymbol{w}^*$ 唯一，并且
    
    $$
    \boldsymbol{w}^* = (\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T\boldsymbol{y}.
    $$

更一般地，对无约束二次函数

$$
f(\boldsymbol{x}) = \frac{1}{2}\boldsymbol{x}^T\boldsymbol{Q}\boldsymbol{x} + \boldsymbol{b}^T\boldsymbol{x}
$$

有

$$
\nabla f(\boldsymbol{x}) = \boldsymbol{Qx} + \boldsymbol{b}.
$$

于是 $\boldsymbol{x}^*$ 为最优点当且仅当

$$
\nabla f(\boldsymbol{x}^*) = \boldsymbol{Qx}^* + \boldsymbol{b} = \boldsymbol{0}.
$$

根据矩阵 $\boldsymbol{Q}$ 的性质，可以分三种情形：

- 情形 1：$\boldsymbol{Q}\succ \boldsymbol{O}$，则存在唯一解  
  $\boldsymbol{x}^* = -\boldsymbol{Q}^{-1}\boldsymbol{b}$；  
- 情形 2：$\det \boldsymbol{Q} = 0$ 且 $\boldsymbol{b} \in \operatorname{Range}(\boldsymbol{Q})$，则最优解不唯一，存在无穷多解；  
- 情形 3：$\det \boldsymbol{Q} = 0$ 且 $\boldsymbol{b} \notin \operatorname{Range}(\boldsymbol{Q})$，则无最优解且 $f^* = -\infty$。

![无约束 QP 的几何形状示意](image.png)

!!! normal-comment "为什么要看 $\boldsymbol{b}$ 与 $\operatorname{Null}(\boldsymbol{Q})$ 的关系？"
    利用线性代数中的基本结论
    
    $$
    \operatorname{Range}(\boldsymbol{A}) = \operatorname{Null}(\boldsymbol{A})^\perp,
    $$
    
    可以把“是否可解”与 $\boldsymbol{b}$ 在 $\boldsymbol{Q}$ 的像空间与核空间中的投影关系联系起来。

!!! examples "一些典型的 QP / QCQP 模型"

    **LOSSO（Least Absolute Shrinkage and Selection Operator）**

    已知 $\boldsymbol{y} \in \mathbb{R}^n, \boldsymbol{X} \in \mathbb{R}^{n \times p}, t > 0$，考虑约束最小二乘

    $$
    \begin{aligned}
        \min_{\boldsymbol{w}}\ &\Vert \boldsymbol{y} - \boldsymbol{Xw} \Vert_2^2 \\
        \text{s.t.}\ &\Vert \boldsymbol{w}\Vert_1 \leq t
    \end{aligned}
    $$

    由于目标函数连续、可行域闭且有界，最优解一定存在；并且在合适条件下最优解唯一。

    **Ridge Regression**

    已知 $\boldsymbol{y} \in \mathbb{R}^n, \boldsymbol{X} \in \mathbb{R}^{n \times p}, t > 0$，

    $$
    \begin{aligned}
        \min_{\boldsymbol{w}}\ &\Vert \boldsymbol{y} - \boldsymbol{Xw} \Vert_2^2 \\
        \text{s.t.}\ &\Vert \boldsymbol{w}\Vert_2 \leq t
    \end{aligned}
    $$

    这是一个标准的 QCQP。

    **SVM（支持向量机）**

    $$
    \begin{aligned}
        \min_{\boldsymbol{w}, b}\ &\frac{1}{2}\Vert\boldsymbol{w}\Vert^2 \\
        \mathrm{s.t.}\ & y_i(\boldsymbol{w}^T \boldsymbol{x}_i + b) \geq 1
    \end{aligned}
    $$

    这是一个具有线性约束的凸 QP。

### 几何规划（Geometric Program）

一个 **monomial** 是定义在正正象限 $\mathbb{R}^n_{++} = \{ \boldsymbol{x} \in \mathbb{R}^n : \boldsymbol{x} > \boldsymbol{0} \}$ 上的函数

$$
f(\boldsymbol{x}) = \gamma x_1^{a_1} x_2^{a_2} \cdots x_n^{a_n},
$$

其中 $\gamma > 0$，$a_1, \ldots, a_n \in \mathbb{R}$。

**Posynomial** 是若干 monomial 的和：

$$
f(\boldsymbol{x}) = \sum_{k=1}^{p} \gamma_k x_1^{a_{k1}} x_2^{a_{k2}} \cdots x_n^{a_{kn}}.
$$

**Geometric program（GP）** 是形如

$$
\begin{aligned}
    \min_{\boldsymbol{x}}\ & f(\boldsymbol{x}) \\
    \text{s.t.}\ & g_i(\boldsymbol{x}) \leq 1, & i = 1, \ldots, m \\
    \ & h_j(\boldsymbol{x}) = 1, & j = 1, \ldots, r
\end{aligned}
$$

的优化问题，其中 $f,\, g_i,\ i = 1,\ldots,m$ 为 posynomial，$h_j,\ j = 1,\ldots,r$ 为 monomial。  
约束 $x > 0$ 通常作为 GP 的隐含条件。


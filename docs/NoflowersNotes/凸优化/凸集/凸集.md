
大多数证明比较简单，就不写了

## Convex Set

A set $C \subset \mathbb{R}^{n}$ is \emph{convex} if the line segment between
any two points $\boldsymbol{x}, \boldsymbol{y} \in C$ lies entirely in $C$, i.e.

$$
\boldsymbol{x} \in C,\;
\boldsymbol{y} \in C,\;
\theta \in [0,1]
\;\Longrightarrow\;
\theta\, \boldsymbol{x} + \bar{\theta}\, \boldsymbol{y} \in C,、
$$

where $\bar{\theta} = 1 - \theta$

For $\theta \in [0, 1]$, $\theta \boldsymbol{x} + \bar{\theta}\boldsymbol{y}$ is called a convex combination of $\boldsymbol{x}$ and $\boldsymbol{y}$  
Similarly, $\displaystyle \sum_{i = 1}^n \theta_i \boldsymbol{x}_i$ is a convex combination of $\boldsymbol{x}_i$ when $\displaystyle \sum_{i = 1}^n \theta_i = 1, \theta_i \geq 0$

!!! examples "Examples of convex sets"

    **Hyperplane**: $P = \{\boldsymbol{x} \in \mathbb{R}^n\ | \ \boldsymbol{w}^T \boldsymbol{x} = b\}$  
    **Halfspaces**: $H = \{\boldsymbol{x} \in \mathbb{R}^n\ | \ \boldsymbol{w}^T \boldsymbol{x} \leq b\}$  
    **Affine spaces**: $S = \{\boldsymbol{x} \in \mathbb{R}^n\ | \ \boldsymbol{A}\boldsymbol{x} = \boldsymbol{b}\}$  
    **Polyhedra**: $\displaystyle G = \bigcap H_i$ where $H_i$ are halfspaces

## Properties of convex sets

**Affine transformation preserves convexity**

The image of a convex set under an affine transformation is convex

**Convex combination**

If $C$ is convex, and $\boldsymbol{x}_1, \boldsymbol{x}_2, \ldots, \boldsymbol{x}_m \in C$, then any convex combination

$$
\sum_{i=1}^{m} \theta_i\, \boldsymbol{x}_i \in C
$$

## Convex Hull (凸包), Simplexes/Simplices (单纯形) and Cone (锥)

### Convex Hull

The convex hull of a set $S \in \mathbb{R}^n$, denoted $\operatorname{conv}S$, is the smallest convex set containing $S$.

$\operatorname{conv} S$ is the set of all convex combinations of points in $S$, i.e.

$$
\operatorname{conv} S
=
\left\{
\sum_{i=1}^{m} \theta_i \boldsymbol{x}_i
:
m \in \mathbb{N},
\boldsymbol{x}_i \in S,
\theta_i \ge 0, i = 1,\ldots,m;
\sum_{i=1}^{m} \theta_i = 1
\right\}
$$

!!! remarks "Proof"
    大概证明两个包含关系就好了，有缘补一下

**Affinely independent points**

$m+1$ points $\boldsymbol{x}_0, \boldsymbol{x}_1, \ldots, \boldsymbol{x}_m \in \mathbb{R}^n$ are affinely independent if $\boldsymbol{x}_1 - \boldsymbol{x}_0,\boldsymbol{x}_2 - \boldsymbol{x}_0,\ldots,\boldsymbol{x}_m - \boldsymbol{x}_0$ are linearly independent

![aff ind pnts](image.png)

$\boldsymbol{x}_0, \boldsymbol{x}_1, \ldots, \boldsymbol{x}_m \in \mathbb{R}^n$ are affinely independent if 

$$
\sum c_i\boldsymbol{x}_i = \boldsymbol{0}, \sum c_i = 0 \Longrightarrow c_i = 0, i \in \{0, 1, \ldots, m\}
$$

In $\mathbb{R}^n$, the maximum number of affinely independent points is $n + 1$

### Simplexes

An $m$-dimensional \emph{simplex}, also called an $m$-simplex, is the convex hull of $m+1$ affinely independent points.

!!! remarks "Note"

    - 0-simplexes are points  
    - 1-simplexes are line segments  
    - 2-simplexes are triangles  
    - 3-simplexes are tetrahedra (四面体)

!!! examples "Examples"

    **Probability $n$-simplex**: $\Delta_n = \{\boldsymbol{\theta} \in \mathbb{R}^{n + 1}:\boldsymbol{\theta} \geq \boldsymbol{0}, \boldsymbol{1}^T \boldsymbol{\theta} = 1\}$  
    **Unit $n$-simplex**: $\Delta_n' = \{\boldsymbol{\theta}' \in \mathbb{R}^{n}:\boldsymbol{\theta}' \geq \boldsymbol{0}, \boldsymbol{1}^T \boldsymbol{\theta}' \leq 1\}$  

The $m$-simplex in $\mathbb{R}^{n}$ determined by affinely independent points
$\boldsymbol{x}_0, \boldsymbol{x}_1, \ldots, \boldsymbol{x}_m$
is the image of $\Delta_m$ under a linear transformation:

$$
\boldsymbol{\theta}
=
\sum_{i=0}^{m} \theta_i \boldsymbol{e}_i
\longmapsto
\boldsymbol{x}
=
\sum_{i=0}^{m} \theta_i \boldsymbol{x}_i
=
\boldsymbol{X}\boldsymbol{\theta},
$$

where 

$$
\boldsymbol{X}
=
[\boldsymbol{x}_0,\boldsymbol{x}_1,\ldots,\boldsymbol{x}_m]
\in \mathbb{R}^{n \times (m+1)},
\boldsymbol{\theta}
=
(\theta_0,\theta_1,\ldots,\theta_m)
\in \Delta_m
$$

Also, 

$$
\boldsymbol{x} = \sum_{i = 0}^m \theta_i \boldsymbol{x}_i = \boldsymbol{x_0} + \sum_{i = 1}^m \theta (\boldsymbol{x}_i - \boldsymbol{x}_0)
$$

The simplex $\operatorname{conv}\{\boldsymbol{x}_0, \ldots, \boldsymbol{x}_m\}$ is also the image of $\Delta_m'$ under the affine transformation 

$$
\boldsymbol{\theta}' \longmapsto \boldsymbol{x} = \boldsymbol{x}_0 + \boldsymbol{B}\boldsymbol{\theta}'
$$

![alt text](image-1.png)

### Convex Cone

A set $C$ is a **cone** if $\theta \boldsymbol{x} \in C$ for every $\boldsymbol{x} \in C$ and $\theta \geq 0$.  
A **convex cone** is a cone that is convex.

A set $C$ is a convex cone iff 

$$
\boldsymbol{x}_1, \boldsymbol{x}_2 \in C, \theta_1, \theta_2 \geq 0 \Longrightarrow \theta_1 \boldsymbol{x}_1 + \theta_2 \boldsymbol{x}_2 \in C
$$

i.e. $C$ is closed under conic combination.

#### Conic Hull

The conic hull of a set $S$, denoted $\operatorname{cone}S$, is the smallest convex cone containing $S$.

$\operatorname{cone} S$ is the set of all conic combinations of points in $S$, i.e.

$$
\operatorname{cone} S
=
\left\{
\sum_{i=1}^{m} \theta_i \boldsymbol{x}_i
:
m \in \mathbb{N},
\boldsymbol{x}_i \in S,
\theta_i \ge 0, i = 1,\ldots,m
\right\}
$$

!!! normal-comment "Difference between "convex" and "conic""
    Just the property of $\sum \theta = 1$

## Supporting and Separating Hyperplanes

### Projection onto convex set

Given a set $C \subset \mathbb{R}$, the distance between a point $\boldsymbol{x}$ and $C$ is 

$$
\operatorname{dist}(\boldsymbol{x}, C) = \inf_{\boldsymbol{z} \in C}\Vert \boldsymbol{x} - \boldsymbol{z}\Vert
$$

If $C$ is nonempty, closed and convex, then for any $\boldsymbol{x}$, there is a **unique** $\boldsymbol{\hat{x}}$ s.t.

$$
\operatorname{dist}(\boldsymbol{x}, C) = \Vert \boldsymbol{x} - \boldsymbol{\hat{x}}\Vert
$$

$\boldsymbol{\hat{x}}$ is called the projection of $\boldsymbol{x}$ onto $C$ and denoted by $\boldsymbol{\hat{x}} = \mathcal{P}_C(\boldsymbol{x})$

$\mathcal{P}_C(\boldsymbol{x}) = \boldsymbol{x}$ iff. $\boldsymbol{x} \in C$

!!! remarks "Proof"

    **Existence**: Let $\boldsymbol{z}_0 \in C$. Then $\operatorname{dist}(\boldsymbol{x}, C) \le \lVert \boldsymbol{x} - \boldsymbol{z}_0 \rVert$.  
    Let $K = \{\boldsymbol{z} \in C : \lVert \boldsymbol{x} - \boldsymbol{z} \rVert \le \lVert \boldsymbol{x} - \boldsymbol{z}_0 \rVert\} = C \cap \overline{B}(\boldsymbol{x}, \lVert \boldsymbol{x} - \boldsymbol{z}_0 \rVert)$.  
    Since $\lVert \boldsymbol{x} - \boldsymbol{z} \rVert$ is continuous in $\boldsymbol{z}$ and $K$ is compact, there exists $\boldsymbol{\hat{x}} \in K$ such that $\operatorname{dist}(\boldsymbol{x}, C) = \lVert \boldsymbol{x} - \boldsymbol{\hat{x}} \rVert$.

    **Uniqueness**: Suppose 
    $\hat{\boldsymbol{x}}_1, \hat{\boldsymbol{x}}_2 \in C$
    satisfy $\operatorname{dist}(\boldsymbol{x}, C)= \lVert \boldsymbol{x} - \hat{\boldsymbol{x}}_1 \rVert= \lVert \boldsymbol{x} - \hat{\boldsymbol{x}}_2 \rVert$.  
    Let $\displaystyle\hat{\boldsymbol{x}}_c = \frac{\hat{\boldsymbol{x}}_1 + \hat{\boldsymbol{x}}_2}{2} \in C$. So 

    $$
    \lVert \boldsymbol{x} - \hat{\boldsymbol{x}}_c \rVert
    \geq \operatorname{dist}(\boldsymbol{x}, C)
    $$

    By the parallelogram law,

    $$
    \lVert y + z \rVert^2 + \lVert y - z \rVert^2
    = 2\lVert y \rVert^2 + 2\lVert z \rVert^2
    $$

    we obtain

    $$
    \lVert \hat{\boldsymbol{x}}_1 - \hat{\boldsymbol{x}}_2 \rVert^2
    = 4\operatorname{dist}^2(\boldsymbol{x}, C)
    -
    4\lVert \boldsymbol{x} - \hat{\boldsymbol{x}}_c \rVert^2
    \le 0
    $$

    so $\boldsymbol{\hat{x}}_1 = \boldsymbol{\hat{x}}_2$

Given $\hat{\boldsymbol{x}} \in C$, $\hat{\boldsymbol{x}} = \mathcal{P}_C(\boldsymbol{x})$ iff

$$
\langle \boldsymbol{x} - \hat{\boldsymbol{x}},\, \boldsymbol{z} - \hat{\boldsymbol{x}} \rangle \le 0,
\quad \forall\, \boldsymbol{z} \in C
$$

![alt text](image-2.png)

!!! remarks "Proof"

    Note $\hat{\boldsymbol{x}} + t(\boldsymbol{z} - \hat{\boldsymbol{x}}) \in C,\forall \boldsymbol{z}\in C,t\in[0,1]$，then 

    $$
    \begin{aligned}
    \hat{\boldsymbol{x}} = \mathcal{P}_C(\boldsymbol{x})
    &\Leftrightarrow
    \|\boldsymbol{x} - \hat{\boldsymbol{x}} - t(\boldsymbol{z} - \hat{\boldsymbol{x}})\|^2
    \geq
    \|\boldsymbol{x} - \hat{\boldsymbol{x}}\|^2, 
    \\&\Leftrightarrow
    -2t\langle \boldsymbol{x} - \hat{\boldsymbol{x}},\, \boldsymbol{z} - \hat{\boldsymbol{x}} \rangle
    + t^2 \|\boldsymbol{z} - \hat{\boldsymbol{x}}\|^2
    \geq 0,
    \\
    &\Leftrightarrow
    \langle \boldsymbol{x} - \hat{\boldsymbol{x}},\boldsymbol{z} - \hat{\boldsymbol{x}} \rangle \leq 0,
    \end{aligned}
    $$

Corollary: 

$$
\Vert\mathcal{P}_C(\boldsymbol{x}) - \mathcal{P}_C(\boldsymbol{x})\Vert \leq \Vert\boldsymbol{x} - \boldsymbol{y}\Vert
$$

For all $\boldsymbol{x_0} \notin C$, there exists $\boldsymbol{w} \in \mathbb{R}^n \setminus \{\boldsymbol{0}\}$ s.t. (1)
{ .annotate}

1. Let $\boldsymbol{w} = \boldsymbol{x_0} - \mathcal{P}_C(\boldsymbol{x}_0)$.

$$
\sup_{\boldsymbol{x} \in C}\langle \boldsymbol{w}, \boldsymbol{x}\rangle < \langle \boldsymbol{w}, \boldsymbol{x_0}\rangle
$$

### Supporting hyperplane

If $C$ is a nonempty, convex set in $\mathbb{R}^n$
and $\boldsymbol{x}_0 \in \partial C$, then there exists 
$\boldsymbol{w} \in \mathbb{R}^n \setminus \{ \boldsymbol{0} \}$ such that

$$
\langle \boldsymbol{w}, \boldsymbol{x} \rangle 
\leq
\langle \boldsymbol{w}, \boldsymbol{x}_0 \rangle,
\quad \forall \boldsymbol{x} \in C
$$

$P = \{\boldsymbol{x} : \boldsymbol{w}^T \boldsymbol{x} = 
\boldsymbol{w}^T \boldsymbol{x}_0\}$ is called a supporting hyperplane to $C$ at $\boldsymbol{x}_0$.

![alt text](image-3.png)

!!! remarks "Boundary, inner part and close hull"
    If $C$ is convex, then $\operatorname{int}C = \operatorname{int}\overline{C}$ and $\partial C = \partial \overline{C}$

    Proof to be completed...

!!! remarks "Proof"

    $\boldsymbol{x}_0 \in \partial C \Rightarrow \boldsymbol{x}_0 \in \partial \overline{C}$ by the previous lemma.  
    There exists a sequence $\{\boldsymbol{x}_k\}$ s.t. $\boldsymbol{x}_k \notin \overline{C}$ and 
    $\boldsymbol{x}_k \to \boldsymbol{x}_0$ as $k \to \infty$  
    Also, there exists $\boldsymbol{w}_k \ne \boldsymbol{0}$ s.t.

    $$
    \langle \boldsymbol{w}_k,\, \boldsymbol{x} \rangle
    <
    \langle \boldsymbol{w}_k,\, \boldsymbol{x}_k \rangle,
    \quad \forall \boldsymbol{x} \in C
    $$

    WLOG, assume $\lVert \boldsymbol{w}_k \rVert = 1$.  
    By the Bolzano-Weierstrass Theorem, $\{\boldsymbol{w}_k\}$ has a convergent subsequence 
    $\boldsymbol{w}_{k_i} \to \boldsymbol{w}$  
    Taking the limit $i \to \infty$ along the subsequence,

    $$
    \langle \boldsymbol{w}_{k_i}, \boldsymbol{x} \rangle
    <
    \langle \boldsymbol{w}_{k_i}, \boldsymbol{x}_{k_i} \rangle
    \;\Longrightarrow\;
    \langle \boldsymbol{w}, \boldsymbol{x} \rangle
    \le
    \langle \boldsymbol{w}, \boldsymbol{x}_0 \rangle
    $$

### Separating Hyperplane

If $C_1, C_2$ are nonempty, convex sets in $\mathbb{R}^n$ with 
$C_1 \cap C_2 = \emptyset$, then $C_1$ and $C_2$ can be separated by a hyperplane, i.e.
there exists $\boldsymbol{w} \in \mathbb{R}^n \setminus \{\boldsymbol{0}\}$,
$b \in \mathbb{R}$ such that

$$
\begin{aligned}
    \boldsymbol{w}^T \boldsymbol{x} \leq b, \forall \boldsymbol{x} \in C_1 \\
    \boldsymbol{w}^T \boldsymbol{x} \geq b, \forall \boldsymbol{x} \in C_2
\end{aligned}
$$

$P = \{ \boldsymbol{x} : \boldsymbol{w}^T \boldsymbol{x} = b \}$ is called a **separating hyperplane** for $C_1$ and $C_2$. (1)
{ .annotate}

1. Proof by find supporting hyperplane or the corollary of $C_1 - C_2$

![alt text](image-4.png)

!!! remarks "Proof"

    It suffices to show there exists a $\boldsymbol{w} \neq \boldsymbol{0}$ s.t. 

    $$
    \boldsymbol{w}^T \boldsymbol{x}_1 \leq \boldsymbol{w}^T \boldsymbol{x}_2, \forall \boldsymbol{x}_1 \in C_1, \boldsymbol{x}_2 \in C_2
    $$

    and let $\displaystyle b = \sup_{\boldsymbol{x}_1 \in C_1 } \boldsymbol{w}^T \boldsymbol{x}_1$.  
    And it is equivalent to

    $$
    \langle \boldsymbol{w}, \boldsymbol{x} \rangle \leq 0, \forall \boldsymbol{x} \in C_1 - C_2
    $$

    Since $\boldsymbol{0} \notin C = C_1 - C_2$, there are two cases:  
    1. $\boldsymbol{0} \notin \overline{C}$, it is the corollary $\displaystyle \sup_{\boldsymbol{x} \in C}\langle \boldsymbol{w}, \boldsymbol{x}\rangle < \langle \boldsymbol{w}, \boldsymbol{x_0}\rangle$  
    2. $\boldsymbol{0} \in \partial C$, it is the supporting hyperplane theorem

### Farkas’ Lemma

Given $\boldsymbol{A} \in \mathbb{R}^{m \times n}$ and 
$\boldsymbol{b} \in \mathbb{R}^{m}$, exactly one of the following sets is empty:  
1. $S_1 = \{ \boldsymbol{x} \in \mathbb{R}^n : \boldsymbol{A}\boldsymbol{x} = \boldsymbol{b},\boldsymbol{x} \geq \boldsymbol{0} \}$  
2. $S_2 = \{ \boldsymbol{y} \in \mathbb{R}^m :\boldsymbol{A}^{T}\boldsymbol{y} \leq \boldsymbol{0}, \boldsymbol{b}^{T}\boldsymbol{y}> 0 \}$

![alt text](image-5.png)
大多数证明都比较直接，这里只记录结论和关键形式，不展开全部细节。

## 凸集（Convex Set）

集合 $C \subset \mathbb{R}^{n}$ 称为 **凸集**，如果对任意两点 $\boldsymbol{x}, \boldsymbol{y} \in C$，连接它们的线段完全落在 $C$ 中，即

$$
\boldsymbol{x} \in C,\;
\boldsymbol{y} \in C,\;
\theta \in [0,1]
\;\Longrightarrow\;
\theta\, \boldsymbol{x} + \bar{\theta}\, \boldsymbol{y} \in C,
$$

其中 $\bar{\theta} = 1 - \theta$。

当 $\theta \in [0, 1]$ 时，$\theta \boldsymbol{x} + \bar{\theta}\boldsymbol{y}$ 称为 $\boldsymbol{x}$ 与 $\boldsymbol{y}$ 的 **凸组合**。  
同理，当满足

$$
\sum_{i = 1}^n \theta_i = 1,\quad \theta_i \geq 0
$$

时，$\displaystyle \sum_{i = 1}^n \theta_i \boldsymbol{x}_i$ 称为点 $\boldsymbol{x}_i$ 的一个凸组合。

!!! examples "一些典型的凸集"

    **超平面（Hyperplane）**：$P = \{\boldsymbol{x} \in \mathbb{R}^n\mid \boldsymbol{w}^T \boldsymbol{x} = b\}$  
    **半空间（Halfspace）**：$H = \{\boldsymbol{x} \in \mathbb{R}^n\mid \boldsymbol{w}^T \boldsymbol{x} \leq b\}$  
    **仿射子空间（Affine space）**：$S = \{\boldsymbol{x} \in \mathbb{R}^n\mid \boldsymbol{A}\boldsymbol{x} = \boldsymbol{b}\}$  
    **多面体（Polyhedron）**：$\displaystyle G = \bigcap H_i$，其中 $H_i$ 为若干半空间。

## 凸集的一些性质（Properties of convex sets）

**仿射变换保持凸性**

凸集在任意仿射变换（affine transformation）下的像仍然是凸的。

**凸组合封闭性**

若 $C$ 是凸集，且 $\boldsymbol{x}_1, \boldsymbol{x}_2, \ldots, \boldsymbol{x}_m \in C$，则任意凸组合

$$
\sum_{i=1}^{m} \theta_i\, \boldsymbol{x}_i \in C
$$

同样属于 $C$。

## 凸包、单纯形与锥（Convex Hull, Simplex, Cone）

### 凸包（Convex Hull）

对集合 $S \subset \mathbb{R}^n$，其 **凸包** 记为 $\operatorname{conv}S$，是包含 $S$ 的最小凸集。

更具体地，$\operatorname{conv} S$ 就是 $S$ 中所有点的凸组合所构成的集合，即

$$
\operatorname{conv} S
=
\left\{
\sum_{i=1}^{m} \theta_i \boldsymbol{x}_i
:
m \in \mathbb{N},
\boldsymbol{x}_i \in S,
\theta_i \ge 0, i = 1,\ldots,m;
\sum_{i=1}^{m} \theta_i = 1
\right\}.
$$

!!! remarks "证明思路"
    证明只需分别验证“所有凸组合构成的集合是凸的且包含 $S$”以及“任意包含 $S$ 的凸集都必然包含这些凸组合”，从而得到最小性。

**仿射无关点（Affinely independent points）**

若 $\boldsymbol{x}_0, \boldsymbol{x}_1, \ldots, \boldsymbol{x}_m \in \mathbb{R}^n$ 满足向量

$$
\boldsymbol{x}_1 - \boldsymbol{x}_0,\ \boldsymbol{x}_2 - \boldsymbol{x}_0,\ \ldots,\ \boldsymbol{x}_m - \boldsymbol{x}_0
$$

线性无关，则称这 $m + 1$ 个点仿射无关。

![仿射无关点示意](image.png)

等价地，$\boldsymbol{x}_0, \boldsymbol{x}_1, \ldots, \boldsymbol{x}_m$ 仿射无关当且仅当

$$
\sum c_i\boldsymbol{x}_i = \boldsymbol{0},\ \sum c_i = 0 \Longrightarrow c_i = 0,\ i \in \{0, 1, \ldots, m\}.
$$

在 $\mathbb{R}^n$ 中，仿射无关点的个数最多为 $n + 1$。

### 单纯形（Simplex）

一个 $m$ 维 **单纯形**（$m$-simplex）是 $m + 1$ 个仿射无关点的凸包。

!!! remarks "一些例子"

    - 0-单纯形就是一个点；  
    - 1-单纯形是线段；  
    - 2-单纯形是三角形；  
    - 3-单纯形是四面体（tetrahedron）。

!!! examples "简单的单纯形例子"

    **概率单纯形（probability $n$-simplex）**：  
    $\Delta_n = \{\boldsymbol{\theta} \in \mathbb{R}^{n + 1}\mid\boldsymbol{\theta} \geq \boldsymbol{0}, \boldsymbol{1}^T \boldsymbol{\theta} = 1\}$  
    **单位单纯形（unit $n$-simplex）**：  
    $\Delta_n' = \{\boldsymbol{\theta}' \in \mathbb{R}^{n}\mid\boldsymbol{\theta}' \geq \boldsymbol{0}, \boldsymbol{1}^T \boldsymbol{\theta}' \leq 1\}$。

在 $\mathbb{R}^{n}$ 中，由仿射无关点
$\boldsymbol{x}_0, \boldsymbol{x}_1, \ldots, \boldsymbol{x}_m$
确定的 $m$ 维单纯形，可以看作是 $\Delta_m$ 在某个线性映射下的像：

$$
\boldsymbol{\theta}
=
\sum_{i=0}^{m} \theta_i \boldsymbol{e}_i
\longmapsto
\boldsymbol{x}
=
\sum_{i=0}^{m} \theta_i \boldsymbol{x}_i
=
\boldsymbol{X}\boldsymbol{\theta},
$$

其中

$$
\boldsymbol{X}
=
[\boldsymbol{x}_0,\boldsymbol{x}_1,\ldots,\boldsymbol{x}_m]
\in \mathbb{R}^{n \times (m+1)},\quad
\boldsymbol{\theta}
=
(\theta_0,\theta_1,\ldots,\theta_m)
\in \Delta_m.
$$

也可以写成

$$
\boldsymbol{x} = \sum_{i = 0}^m \theta_i \boldsymbol{x}_i = \boldsymbol{x_0} + \sum_{i = 1}^m \theta (\boldsymbol{x}_i - \boldsymbol{x}_0).
$$

同样，单纯形 $\operatorname{conv}\{\boldsymbol{x}_0, \ldots, \boldsymbol{x}_m\}$ 也可以看作 $\Delta_m'$ 在某个仿射变换下的像：

$$
\boldsymbol{\theta}' \longmapsto \boldsymbol{x} = \boldsymbol{x}_0 + \boldsymbol{B}\boldsymbol{\theta}'.
$$

![单纯形的另一种表示](image-1.png)

### 凸锥与锥包（Convex Cone and Conic Hull）

集合 $C$ 称为一个 **锥（cone）**，如果对任意 $\boldsymbol{x} \in C$ 和 $\theta \geq 0$，都有 $\theta \boldsymbol{x} \in C$。  
若 $C$ 既是锥又是凸集，则称为 **凸锥（convex cone）**。

等价地，$C$ 是凸锥当且仅当

$$
\boldsymbol{x}_1, \boldsymbol{x}_2 \in C,\ \theta_1, \theta_2 \geq 0 \Longrightarrow \theta_1 \boldsymbol{x}_1 + \theta_2 \boldsymbol{x}_2 \in C,
$$

即 $C$ 对所有 **锥组合（conic combination）** 封闭。

#### 锥包（Conic Hull）

集合 $S$ 的锥包记为 $\operatorname{cone}S$，是包含 $S$ 的最小凸锥。

更具体地，$\operatorname{cone} S$ 是 $S$ 中所有点的锥组合所构成的集合，即

$$
\operatorname{cone} S
=
\left\{
\sum_{i=1}^{m} \theta_i \boldsymbol{x}_i
:
m \in \mathbb{N},
\boldsymbol{x}_i \in S,
\theta_i \ge 0,\ i = 1,\ldots,m
\right\}.
$$

!!! normal-comment "“Convex” 与 “conic” 的区别"
    凸组合要求系数非负且和为 1；锥组合只要求系数非负，不要求和为 1。

## 支撑与分离超平面（Supporting and Separating Hyperplanes）

### 到凸集的投影（Projection onto convex set）

给定集合 $C \subset \mathbb{R}^n$，点 $\boldsymbol{x}$ 到集合 $C$ 的距离定义为

$$
\operatorname{dist}(\boldsymbol{x}, C) = \inf_{\boldsymbol{z} \in C}\Vert \boldsymbol{x} - \boldsymbol{z}\Vert.
$$

若 $C$ 非空、闭合且凸，则对任意 $\boldsymbol{x}$，都存在一个 **唯一的** 点 $\boldsymbol{\hat{x}} \in C$ 满足

$$
\operatorname{dist}(\boldsymbol{x}, C) = \Vert \boldsymbol{x} - \boldsymbol{\hat{x}}\Vert.
$$

这个点 $\boldsymbol{\hat{x}}$ 称为 $\boldsymbol{x}$ 在 $C$ 上的 **投影**，记为 $\boldsymbol{\hat{x}} = \mathcal{P}_C(\boldsymbol{x})$。  
显然，$\mathcal{P}_C(\boldsymbol{x}) = \boldsymbol{x}$ 当且仅当 $\boldsymbol{x} \in C$。

!!! remarks "存在性与唯一性"

    **存在性**：任取 $\boldsymbol{z}_0 \in C$，则
    
    $$
    \operatorname{dist}(\boldsymbol{x}, C) \le \lVert \boldsymbol{x} - \boldsymbol{z}_0 \rVert.
    $$
    
    令
    
    $$
    K = \{\boldsymbol{z} \in C : \lVert \boldsymbol{x} - \boldsymbol{z} \rVert \le \lVert \boldsymbol{x} - \boldsymbol{z}_0 \rVert\} = C \cap \overline{B}(\boldsymbol{x}, \lVert \boldsymbol{x} - \boldsymbol{z}_0 \rVert).
    $$
    
    由于 $\lVert \boldsymbol{x} - \boldsymbol{z} \rVert$ 关于 $\boldsymbol{z}$ 连续且 $K$ 是紧集，在 $K$ 上必然能取到最小值，即存在 $\boldsymbol{\hat{x}} \in K$ 使得 $\operatorname{dist}(\boldsymbol{x}, C) = \lVert \boldsymbol{x} - \boldsymbol{\hat{x}} \rVert$。

    **唯一性**：若 $\hat{\boldsymbol{x}}_1, \hat{\boldsymbol{x}}_2 \in C$ 都达到最小距离，即
    
    $$
    \operatorname{dist}(\boldsymbol{x}, C)= \lVert \boldsymbol{x} - \hat{\boldsymbol{x}}_1 \rVert= \lVert \boldsymbol{x} - \hat{\boldsymbol{x}}_2 \rVert,
    $$
    
    令 $\displaystyle\hat{\boldsymbol{x}}_c = \frac{\hat{\boldsymbol{x}}_1 + \hat{\boldsymbol{x}}_2}{2} \in C$。由于 $\hat{\boldsymbol{x}}_c$ 也在 $C$ 中，有
    
    $$
    \lVert \boldsymbol{x} - \hat{\boldsymbol{x}}_c \rVert
    \geq \operatorname{dist}(\boldsymbol{x}, C).
    $$
    
    由平行四边形恒等式
    
    $$
    \lVert y + z \rVert^2 + \lVert y - z \rVert^2
    = 2\lVert y \rVert^2 + 2\lVert z \rVert^2
    $$
    
    可推出
    
    $$
    \lVert \hat{\boldsymbol{x}}_1 - \hat{\boldsymbol{x}}_2 \rVert^2
    = 4\operatorname{dist}^2(\boldsymbol{x}, C)
    -
    4\lVert \boldsymbol{x} - \hat{\boldsymbol{x}}_c \rVert^2
    \le 0,
    $$
    
    从而 $\hat{\boldsymbol{x}}_1 = \hat{\boldsymbol{x}}_2$。

对给定的 $\hat{\boldsymbol{x}} \in C$，投影 $\hat{\boldsymbol{x}} = \mathcal{P}_C(\boldsymbol{x})$ 还可以通过下述性质来刻画：

$$
\langle \boldsymbol{x} - \hat{\boldsymbol{x}},\, \boldsymbol{z} - \hat{\boldsymbol{x}} \rangle \le 0,
\quad \forall\, \boldsymbol{z} \in C.
$$

![投影几何意义示意图](image-2.png)

!!! remarks "证明"

    注意对任意 $\boldsymbol{z}\in C,t\in[0,1]$，点
    
    $$
    \hat{\boldsymbol{x}} + t(\boldsymbol{z} - \hat{\boldsymbol{x}}) \in C,
    $$
    
    于是
    
    $$
    \begin{aligned}
    \hat{\boldsymbol{x}} = \mathcal{P}_C(\boldsymbol{x})
    &\Leftrightarrow
    \|\boldsymbol{x} - \hat{\boldsymbol{x}} - t(\boldsymbol{z} - \hat{\boldsymbol{x}})\|^2
    \geq
    \|\boldsymbol{x} - \hat{\boldsymbol{x}}\|^2, 
    \\
    &\Leftrightarrow
    -2t\langle \boldsymbol{x} - \hat{\boldsymbol{x}},\, \boldsymbol{z} - \hat{\boldsymbol{x}} \rangle
    + t^2 \|\boldsymbol{z} - \hat{\boldsymbol{x}}\|^2
    \geq 0,
    \\
    &\Leftrightarrow
    \langle \boldsymbol{x} - \hat{\boldsymbol{x}},\boldsymbol{z} - \hat{\boldsymbol{x}} \rangle \leq 0.
    \end{aligned}
    $$

由此可以得到一个推论：

$$
\Vert\mathcal{P}_C(\boldsymbol{x}) - \mathcal{P}_C(\boldsymbol{y})\Vert \leq \Vert\boldsymbol{x} - \boldsymbol{y}\Vert,
$$

即投影算子是 1-Lipschitz 的。

此外，对任意 $\boldsymbol{x_0} \notin C$，存在非零向量 $\boldsymbol{w} \in \mathbb{R}^n \setminus \{\boldsymbol{0}\}$ 使得

$$
\sup_{\boldsymbol{x} \in C}\langle \boldsymbol{w}, \boldsymbol{x}\rangle < \langle \boldsymbol{w}, \boldsymbol{x_0}\rangle.
$$

其中一个自然的选择是

$$
\boldsymbol{w} = \boldsymbol{x_0} - \mathcal{P}_C(\boldsymbol{x}_0).
$$

### 支撑超平面（Supporting hyperplane）

若 $C$ 是 $\mathbb{R}^n$ 中的非空凸集，$\boldsymbol{x}_0 \in \partial C$，则存在向量
$\boldsymbol{w} \in \mathbb{R}^n \setminus \{ \boldsymbol{0} \}$，使得

$$
\langle \boldsymbol{w}, \boldsymbol{x} \rangle 
\leq
\langle \boldsymbol{w}, \boldsymbol{x}_0 \rangle,
\quad \forall \boldsymbol{x} \in C.
$$

此时

$$
P = \{\boldsymbol{x} : \boldsymbol{w}^T \boldsymbol{x} = 
\boldsymbol{w}^T \boldsymbol{x}_0\}
$$

称为 $C$ 在点 $\boldsymbol{x}_0$ 处的 **支撑超平面**。

![支撑超平面示意图](image-3.png)

!!! remarks "边界、内部与闭包"
    若 $C$ 为凸集，则有 $\operatorname{int}C = \operatorname{int}\overline{C}$ 且 $\partial C = \partial \overline{C}$。  
    证明可以基于支撑超平面定理与闭包的性质。

!!! remarks "一个证明思路"

    由上一个结论可知 $\boldsymbol{x}_0 \in \partial C \Rightarrow \boldsymbol{x}_0 \in \partial \overline{C}$。  
    可以构造一列点 $\{\boldsymbol{x}_k\}$，满足 $\boldsymbol{x}_k \notin \overline{C}$ 且 $\boldsymbol{x}_k \to \boldsymbol{x}_0$。  
    对每个 $k$，存在 $\boldsymbol{w}_k \ne \boldsymbol{0}$ 满足

    $$
    \langle \boldsymbol{w}_k,\, \boldsymbol{x} \rangle
    <
    \langle \boldsymbol{w}_k,\, \boldsymbol{x}_k \rangle,
    \quad \forall \boldsymbol{x} \in C.
    $$

    不妨设 $\lVert \boldsymbol{w}_k \rVert = 1$。  
    由 Bolzano-Weierstrass 定理，序列 $\{\boldsymbol{w}_k\}$ 存在收敛子列 $\boldsymbol{w}_{k_i} \to \boldsymbol{w}$。  
    沿该子列取极限，可得

    $$
    \langle \boldsymbol{w}_{k_i}, \boldsymbol{x} \rangle
    <
    \langle \boldsymbol{w}_{k_i}, \boldsymbol{x}_{k_i} \rangle
    \;\Longrightarrow\;
    \langle \boldsymbol{w}, \boldsymbol{x} \rangle
    \le
    \langle \boldsymbol{w}, \boldsymbol{x}_0 \rangle,
    $$

    从而得到支撑超平面。

### 分离超平面（Separating Hyperplane）

若 $C_1, C_2$ 是 $\mathbb{R}^n$ 中的两个非空凸集，且 $C_1 \cap C_2 = \emptyset$，则它们可以被某个超平面分离：  
存在 $\boldsymbol{w} \in \mathbb{R}^n \setminus \{\boldsymbol{0}\}$、$b \in \mathbb{R}$ 使得

$$
\begin{aligned}
    \boldsymbol{w}^T \boldsymbol{x} \leq b, &\quad \forall \boldsymbol{x} \in C_1, \\
    \boldsymbol{w}^T \boldsymbol{x} \geq b, &\quad \forall \boldsymbol{x} \in C_2.
\end{aligned}
$$

此时

$$
P = \{ \boldsymbol{x} : \boldsymbol{w}^T \boldsymbol{x} = b \}
$$

称为 $C_1$ 与 $C_2$ 的一个 **分离超平面**。  
一种理解方式是通过 $C_1 - C_2$ 的支撑超平面来构造。

![分离超平面示意图](image-4.png)

!!! remarks "证明思路"

    只要证明存在 $\boldsymbol{w} \neq \boldsymbol{0}$ 使得

    $$
    \boldsymbol{w}^T \boldsymbol{x}_1 \leq \boldsymbol{w}^T \boldsymbol{x}_2,\quad \forall \boldsymbol{x}_1 \in C_1, \boldsymbol{x}_2 \in C_2,
    $$

    然后令
    
    $$
    b = \sup_{\boldsymbol{x}_1 \in C_1 } \boldsymbol{w}^T \boldsymbol{x}_1。
    $$
    
    这等价于要求

    $$
    \langle \boldsymbol{w}, \boldsymbol{x} \rangle \leq 0,\quad \forall \boldsymbol{x} \in C_1 - C_2.
    $$

    记 $C = C_1 - C_2$。由于 $\boldsymbol{0} \notin C$，分两种情况：  
    1. 若 $\boldsymbol{0} \notin \overline{C}$，可以直接使用前面的投影推论；  
    2. 若 $\boldsymbol{0} \in \partial C$，则由支撑超平面定理得到所需结论。

### Farkas 引理（Farkas’ Lemma）

给定矩阵 $\boldsymbol{A} \in \mathbb{R}^{m \times n}$ 与向量 $\boldsymbol{b} \in \mathbb{R}^{m}$，下面两类线性系统中，恰好有且只有一个是不可行的：

1. $S_1 = \{ \boldsymbol{x} \in \mathbb{R}^n : \boldsymbol{A}\boldsymbol{x} = \boldsymbol{b},\ \boldsymbol{x} \geq \boldsymbol{0} \}$；  
2. $S_2 = \{ \boldsymbol{y} \in \mathbb{R}^m :\boldsymbol{A}^{T}\boldsymbol{y} \leq \boldsymbol{0},\ \boldsymbol{b}^{T}\boldsymbol{y}> 0 \}$。

![Farkas 引理几何直观](image-5.png)


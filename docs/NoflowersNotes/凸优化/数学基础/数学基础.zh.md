~~上学期数分都快忘光了，先简单复习一下基础分析~~

## 导数与梯度（Derivative and Gradient）

设函数 $\boldsymbol{f} : S \subset \mathbb{R}^n \to \mathbb{R}^m$，若在点 $\boldsymbol{x}_0 \in \operatorname{int} S$ 处存在矩阵 $\boldsymbol{A} \in \mathbb{R}^{m \times n}$，使得

$$
\lim_{\Delta \boldsymbol{x} \to \boldsymbol{0}}
\frac{
\boldsymbol{f}(\boldsymbol{x}_0 + \Delta \boldsymbol{x}) 
- \boldsymbol{f}(\boldsymbol{x}_0)
- \boldsymbol{A}\,\Delta \boldsymbol{x}
}{
\lVert \Delta \boldsymbol{x} \rVert
}
= 0,
$$

即

$$
\boldsymbol{f}(\boldsymbol{x})
=
\boldsymbol{f}(\boldsymbol{x}_0)
+
\boldsymbol{A}(\boldsymbol{x} - \boldsymbol{x}_0)
+
o(\lVert \boldsymbol{x} - \boldsymbol{x}_0 \rVert),
$$

则称 $\boldsymbol{f}$ 在 $\boldsymbol{x}_0$ 处可微，并把这个矩阵 $\boldsymbol{A}$ 称为 $\boldsymbol{f}$ 在 $\boldsymbol{x}_0$ 处的导数：

$$
\boldsymbol{f}'(\boldsymbol{x}_0) = D\boldsymbol{f}(\boldsymbol{x}_0) = \boldsymbol{A}
$$

其中

$$
[D\boldsymbol{f}(\boldsymbol{x}_0)]_{ij} = \frac{\partial f_i(\boldsymbol{x_0})}{\partial x_j}
$$

并且对每一维分量都有

$$
f_i(\boldsymbol{x}_0 + \Delta \boldsymbol{x})
= f_i(\boldsymbol{x}_0)
+ \sum_{j=1}^{n}
    \frac{\partial f_i(\boldsymbol{x}_0)}{\partial x_j}\,
    \Delta x_j
+ o(\lVert \Delta \boldsymbol{x} \rVert),
\ i = 1, 2, \ldots, m.
$$

当 $f:\mathbb{R}^n \to \mathbb{R}$ 是实值函数时，其导数 $f'(\boldsymbol{x})$ 是行向量，其转置就是常见的 **梯度**（gradient），为列向量。

$$
f'(\boldsymbol{x})\Delta \boldsymbol{x} = \langle \nabla f(\boldsymbol{x}), \boldsymbol{x} \rangle = \nabla f(\boldsymbol{x})^T \boldsymbol{x}
$$

!!! examples "几个常见的求导公式"

    （来自上学期线代笔记）

    $$
    \begin{align}
        &\frac{\mathrm{d}\boldsymbol{x}^T \boldsymbol{y}}{\mathrm{d}\boldsymbol{x}} = \frac{\mathrm{d}\boldsymbol{y}^T \boldsymbol{x}}{\mathrm{d}\boldsymbol{x}} = \boldsymbol{y} & \quad \text{内积的导数} \\
        & \frac{\mathrm{d}\boldsymbol{x}^T \boldsymbol{Ax}}{\mathrm{d}\boldsymbol{x}} = (\boldsymbol{A} + \boldsymbol{A}^T)\boldsymbol{x} & \\
        & \frac{\mathrm{d}\ \mathrm{tr}(\boldsymbol{B}^T\boldsymbol{A})}{\mathrm{d}\boldsymbol{A}} = \boldsymbol{B} & \\
        & \frac{\mathrm{d}\ \mathrm{tr}(\boldsymbol{X}^T\boldsymbol{A}\boldsymbol{X})}{\mathrm{d}\boldsymbol{X}} = (\boldsymbol{A} + \boldsymbol{A}^T)\boldsymbol{X} & \\
        & \frac{\mathrm{d}\det \boldsymbol{}}{\mathrm{d}\boldsymbol{A}} = \det \boldsymbol{A} (\boldsymbol{A}^{-1})^T
    \end{align}
    $$

## 二阶导数（Second-order derivative）

对函数 $f : S \subset \mathbb{R}^n \to \mathbb{R}$，在 $\boldsymbol{x}_0 \in \operatorname{int} S$ 处的二阶偏导定义为

$$
\frac{\partial^2 f(\boldsymbol{x}_0)}{\partial x_i \partial x_j}
\;\triangleq\;
\left.
\frac{\partial}{\partial x_i}
\left( \frac{\partial f(x)}{\partial x_j} \right)
\right|_{x = \boldsymbol{x}_0},
\quad i,j = 1,2,\ldots,n.
$$

**Hessian 矩阵** 定义为

$$
\bigl[ \boldsymbol{\nabla}^2 f(\boldsymbol{x}_0) \bigr]_{ij}
\;=\;
\frac{\partial^2 f(\boldsymbol{x}_0)}{\partial x_i \partial x_j},
\quad i,j = 1,2,\ldots,n.
$$

对 $f : \mathbb{R}^n \to \mathbb{R}$，其二阶泰勒展开可以写成

$$
f(\boldsymbol{x} + \boldsymbol{d})
=
f(\boldsymbol{x})
+ \nabla f(\boldsymbol{x})^{T} \boldsymbol{d}
+ \frac{1}{2}
\boldsymbol{d}^{T}\nabla^{2} f(\boldsymbol{x})
\boldsymbol{d}
+ o(\lVert \boldsymbol{d} \rVert^{2}).
$$

## 一些补充（Other appendixes）

### 二次型的界（Bounds on quadratic forms）

对称矩阵 $\boldsymbol{A} \in \mathbb{R}^{n \times n}$ 满足

$$
\lambda_{\min}\, \lVert \boldsymbol{x} \rVert_2^{2}
\;\le\;
\boldsymbol{x}^{T} \boldsymbol{A}\, \boldsymbol{x}
\;\le\;
\lambda_{\max}\, \lVert \boldsymbol{x} \rVert_2^{2},
\qquad
\forall\, \boldsymbol{x} \in \mathbb{R}^{n},
$$

其中 $\lambda_{\max}$ 和 $\lambda_{\min}$ 分别是 $\boldsymbol{A}$ 的最大和最小特征值。

### 二阶充分条件（Second-order sufficient condition）

若 $f : \mathbb{R}^{n} \to \mathbb{R}$ 二阶连续可微，并且 $\boldsymbol{x}^{*}$ 是 $f$ 的一个局部极小点，则其 Hessian 矩阵 $\boldsymbol{\nabla}^{2} f(\boldsymbol{x}^{*})$ 必为半正定矩阵，即

$$
\boldsymbol{d}^{T}\,
\boldsymbol{\nabla}^{2} f(\boldsymbol{x}^{*})\,
\boldsymbol{d}
\;\ge\; 0,
\quad \forall\, \boldsymbol{d} \in \mathbb{R}^{n}.
$$


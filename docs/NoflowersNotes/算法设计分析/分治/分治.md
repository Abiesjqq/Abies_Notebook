## Number Multiplication

- Calculate by dividing the two n-digit into two parts and recursion -- $O(n^2)$  
- Improvement;

$$
xy = ac \cdot 10^n + (ad + bc) \cdot 10^{n / 2} + bd
$$

where $ad + bc = (a + c) (b + d) - ac - bd$, using 3 times of multiplication instead of 4.  
We have time complexity (multiply times) of $\displaystyle O(3^{\log n}) \approx O(n^{1.6})$

!!! remarks "If $n$ is not 2's power?"
    Add $0$.

**Karatsuba Algorithm**

$$
T(n) = 3T\left(\frac{n}{2}\right) + O(n)
$$

> To be accurate, $3T(n / 2)$ should be $3T(n / 2 + 1)$, as $a + b, c + d$ may be of $(2n + 1)$-bit length (due to carry).

$$
\begin{aligned}
T(n) &= 3\Bigg( 3T\!\left(\frac{n}{4}\right) + c \cdot \frac{n}{2} \Bigg) + cn 
     = 3^2 T\!\left(\frac{n}{4}\right) + cn\left(1 + \frac{3}{2}\right) \\[6pt]
     &= 3^3 T\!\left(\frac{n}{2^3}\right) + cn\left(1 + \frac{3}{2} + \left(\frac{3}{2}\right)^2\right) \\[6pt]
     &= 3^4 T\!\left(\frac{n}{2^4}\right) + cn\left(1 + \frac{1}{2} + \left(\frac{3}{2}\right)^2 + \left(\frac{3}{2}\right)^3\right) \\[6pt]
     &\ \ \vdots \\[6pt]
     &= 3^{\log_2 n}T(1) 
        + cn\left(1 + \frac{1}{2} + \left(\frac{3}{2}\right)^2 + \left(\frac{3}{2}\right)^3 + \cdots 
        + \left(\frac{3}{2}\right)^{\log_2 n - 1}\right) \\[6pt]
     &= O\!\left(n^{\log_2 3}\right) + O\!\left(n^{1+\log_2 1.5}\right) 
      = O\!\left(n^{\log_2 3}\right)
\end{aligned}
$$

**Other better algorithms**

- Toom-Cook: dividing into 3 parts, reduce 9 multiplication into 5 times. --> $O(n^{1.465})$
- Schonhage-Strassen ($O(n \log n \log log n)$)... (based on FFT)

## Matrix multiplication

Directly calculate, $O(n^3)$

Strassen’s magical idea:

$$
\begin{cases}
P_{1} = A(F - H) \\
P_{2} = (A + B)H \\
P_{3} = (C + D)E \\
P_{4} = D(G - E) \\
P_{5} = (A + D)(E + H) \\
P_{6} = (B - D)(G + H) \\
P_{7} = (A - C)(E + F)
\end{cases}
$$

then 

$$
\begin{aligned}
XY &= 
\begin{pmatrix}
A & B \\
C & D
\end{pmatrix}
\begin{pmatrix}
E & F \\
G & H
\end{pmatrix} \\[6pt]
&=
\begin{pmatrix}
AE + BG & AF + BH \\
CE + DG & BF + DH
\end{pmatrix} \\[6pt]
&=
\begin{pmatrix}
P_{5} + P_{4} - P_{2} + P_{6} & P_{1} + P_{2} \\
P_{3} + P_{4} & P_{1} + P_{5} - P_{3} - P_{7}
\end{pmatrix}
\end{aligned}
$$

reducing 8 multiplication into 7.

Others:
- Strassen: $n^\omega, \omega \leq \log_2^7$
- Conjecture (猜想) $\omega = 2 + \varepsilon$ for any $\varepsilon > 0$.

## Sorting

(Omitted)

Merge Sort analysis:

$$
T(n) = 2T\left(\frac{n}{2}\right) + O(n)
$$

So 

$$
T(n) \leq 2T(n / 2) + cn \leq 2 B \cdot \frac{n}{2} \log \frac{n}{2} + cn \leq Bn\log n
$$

!!! remarks "The lower bound of compare sorting is $\Omega(n \log n)$"
    Total number of possible outputs is $3^{K(n)}$ if $K(n)$ comparisons are made.   
    The total number of possible orders is $n!$, and the algorighm needs to distinguish them. So  

    $$
    3^{K(n)} \geq n! \Rightarrow K(n) \geq \log
    $$


## Master Theorem

If $T(n) = aT(n / b) + O(n^d)$, then

$$
T(n) = 
\begin{cases}
\displaystyle O(n^d), &\quad a < b^d \\
\displaystyle O(n^{\log_ba}), &\quad a > b^d \\
\displaystyle O(n^d\log n), &\quad a = b^d
\end{cases}
$$

## Selection Problem

Find the $k$-th smallest integer among $x_1, \cdots, x_n$,  

A solution the same as quick sort: select the arbitrary item $x_0$ and divide the array into $L: x < x_0, M: x = x_0, R: x > x_0$, and recurse.  
> However, the worse case is $O(n^2)$.

**Median of the medians** (1973)

> step1. partition S into subsets with size 5 ($O(n)$)  
> step2. find the medians of the median of each subset ($O(n)$)  
> step3. fix $x_0$ to be the median of all the medians (by recursion: the $n / 2$ least) ($T(n / 5)$)

Analysis: there is about $3n / 10$ numbers larger than $x_0$ in the worst case, i.e. $\text{the-} 3 / 10 \text{-th} \leq x_0 \leq \text{the-} 7 / 10 \text{-th}$ (Why?)

So $T(n) = T(n / 5) + T(7n / 10) + O(n)$

> $T(n) --> 0.9T(n)$ after each iteration, so we guess $T(n) \leq Bn$.

$$
T(n) \leq \frac{1}{5}Bn + \frac{7}{10}Bn + Cn \leq 0.9Bn + Cn \leq Bn
$$

holds if $B \geq 10C$.

So $T(n) = O(n)$

!!! remarks "So why we divide into size 5?"

    Assume we divide into size $t$, then $\displaystyle x_0 \in \left[\frac{3t - 1}{4t}, \frac{t + 1}{4t}\right]$ (when $t$ is odd). So
    
    $$
    T(n) = T(n / t) + T\left(\frac{(3t - 1)n}{4t}\right) + O(n)
    $$
    
    $T(n) = O(n)$ iff. $\displaystyle \frac{1}{t} + \frac{(3t - 1)}{4t} \leq 1$ iff. $t \geq 5$.

    * _If $t = 3$, $T(n) = O(n \log n)$_

## Quick Sort

By _Median of the medians_, we have $O(n)$ to find the median number. So

$$
T(n) = 2T(n / 2) + O(n) \Rightarrow T(n) = O(n \log n)
$$

> However, it is low in practice! (_Median of the medians_ is low due to the large constant $B$!)

**Choose the pivot item by random**:

let $a_i$: the $i$-th smallest number in the array, $\displaystyle X_{ij} =\begin{cases}1, & a_i, a_j \text{ have been compared} \\ 0, &\text{otherwise}\end{cases} $, and $X: \text{Total compare times}$.  

So we have $\mathbb{E}(X) = \mathbb{E}\sum X_{ij} = \sum P(X_{ij} = 1)$.

$X_{ij} = 0$ iff. $a_i, a_j$ have been divided into 2 different groups. Noting that all the number will be chosen once during the whole algorithm, and we only pay attention to the first number chosen between $a_i, a_j$. So $\displaystyle P(X_{ij} = 1) = \frac{2}{j - i + 1}$ (they are not divided at first).

So $\displaystyle \mathbb{E}(X) = \sum \frac{2}{j - i + 1} = \Theta (n \log n)$

!!! remarks "The derivation"
    
    Let $d = j - i$

    $$
    \begin{align}
    \mathbb{E}(X) =& \sum_{d = 1}^{n - 1}\frac{2(n - d)}{d + 1} \\
    =& (2n + 2)\sum_{d = 1}^{n - 1}\frac{1}{d + 1} - 2(n - 1) \\
     \approx& (2n + 2)\log n - 2(n - 1) = \Theta (n \log n)
    \end{align}
    $$

## Closest Pairs

Find the closest dot pair on the 2-D plane.